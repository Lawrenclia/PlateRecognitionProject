import matplotlib.pyplot as plt
import numpy as np

# 从数据中提取epoch和准确度指标
epochs = list(range(5, 101))  # 从第5个epoch开始

# 准确度数据 (从第5个epoch开始)
acc = [0.7463, 0.7463, 0.7463, 0.7463, 0.7463, 0.8497, 0.8497, 0.8497, 0.8497, 0.8497,
       0.8928, 0.8928, 0.8928, 0.8928, 0.8928, 0.8967, 0.8967, 0.8967, 0.8967, 0.8967,
       0.9369, 0.9369, 0.9369, 0.9369, 0.9369, 0.9586, 0.9586, 0.9586, 0.9586, 0.9586,
       0.9557, 0.9557, 0.9557, 0.9557, 0.9557, 0.9573, 0.9573, 0.9573, 0.9573, 0.9573,
       0.9639, 0.9639, 0.9639, 0.9639, 0.9639, 0.9605, 0.9605, 0.9605, 0.9605, 0.9605,
       0.9623, 0.9623, 0.9623, 0.9623, 0.9623, 0.9656, 0.9656, 0.9656, 0.9656, 0.9656,
       0.9713, 0.9713, 0.9713, 0.9713, 0.9713, 0.9722, 0.9722, 0.9722, 0.9722, 0.9722,
       0.9738, 0.9738, 0.9738, 0.9738, 0.9738, 0.9777, 0.9777, 0.9777, 0.9777, 0.9777,
       0.9797, 0.9797, 0.9797, 0.9797, 0.9797, 0.9809, 0.9809, 0.9809, 0.9809, 0.9809,
       0.9823, 0.9823, 0.9823, 0.9823, 0.9823, 0.9835]

mean_iou = [0.9899, 0.9899, 0.9899, 0.9899, 0.9899, 0.9935, 0.9935, 0.9935, 0.9935, 0.9935,
            0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9943, 0.9943, 0.9943, 0.9943, 0.9943,
            0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9949, 0.9949, 0.9949, 0.9949, 0.9949,
            0.995, 0.995, 0.995, 0.995, 0.995, 0.9953, 0.9953, 0.9953, 0.9953, 0.9953,
            0.9952, 0.9952, 0.9952, 0.9952, 0.9952, 0.9949, 0.9949, 0.9949, 0.9949, 0.9949,
            0.9946, 0.9946, 0.9946, 0.9946, 0.9946, 0.9946, 0.9946, 0.9946, 0.9946, 0.9946,
            0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9945,
            0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
            0.9945, 0.9945, 0.9945, 0.9945, 0.9945, 0.9944, 0.9944, 0.9944, 0.9944, 0.9944,
            0.9944, 0.9944, 0.9944, 0.9944, 0.9944, 0.9945]

top1_acc = [0.01343, 0.01343, 0.01343, 0.01343, 0.01343, 0.01198, 0.01198, 0.01198, 0.01198, 0.01198,
            0.0115, 0.0115, 0.0115, 0.0115, 0.0115, 0.01111, 0.01111, 0.01111, 0.01111, 0.01111,
            0.01058, 0.01058, 0.01058, 0.01058, 0.01058, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104,
            0.01024, 0.01024, 0.01024, 0.01024, 0.01024, 0.01007, 0.01007, 0.01007, 0.01007, 0.01007,
            0.01001, 0.01001, 0.01001, 0.01001, 0.01001, 0.00998, 0.00998, 0.00998, 0.00998, 0.00998,
            0.009938, 0.009938, 0.009938, 0.009938, 0.009938, 0.009913, 0.009913, 0.009913, 0.009913, 0.009913,
            0.009895, 0.009895, 0.009895, 0.009895, 0.009895, 0.009884, 0.009884, 0.009884, 0.009884, 0.009884,
            0.009871, 0.009871, 0.009871, 0.009871, 0.009871, 0.009857, 0.009857, 0.009857, 0.009857, 0.009857,
            0.009837, 0.009837, 0.009837, 0.009837, 0.009837, 0.009826, 0.009826, 0.009826, 0.009826, 0.009826,
            0.009812, 0.009812, 0.009812, 0.009812, 0.009812, 0.009801]

top5_acc = [0.00404, 0.00404, 0.00404, 0.00404, 0.00404, 0.003284, 0.003284, 0.003284, 0.003284, 0.003284,
            0.003039, 0.003039, 0.003039, 0.003039, 0.003039, 0.002947, 0.002947, 0.002947, 0.002947, 0.002947,
            0.002852, 0.002852, 0.002852, 0.002852, 0.002852, 0.00279, 0.00279, 0.00279, 0.00279, 0.00279,
            0.002759, 0.002759, 0.002759, 0.002759, 0.002759, 0.002721, 0.002721, 0.002721, 0.002721, 0.002721,
            0.002687, 0.002687, 0.002687, 0.002687, 0.002687, 0.002666, 0.002666, 0.002666, 0.002666, 0.002666,
            0.002651, 0.002651, 0.002651, 0.002651, 0.002651, 0.002633, 0.002633, 0.002633, 0.002633, 0.002633,
            0.002618, 0.002618, 0.002618, 0.002618, 0.002618, 0.002603, 0.002603, 0.002603, 0.002603, 0.002603,
            0.00259, 0.00259, 0.00259, 0.00259, 0.00259, 0.002575, 0.002575, 0.002575, 0.002575, 0.002575,
            0.002561, 0.002561, 0.002561, 0.002561, 0.002561, 0.002548, 0.002548, 0.002548, 0.002548, 0.002548,
            0.002536, 0.002536, 0.002536, 0.002536, 0.002536, 0.002525]

plt.figure(figsize=(12, 8))

# 绘制准确度曲线
plt.subplot(2, 2, 1)
plt.plot(epochs, acc, 'b-', linewidth=2, label='Accuracy')
plt.title('Accuracy Over Epochs')
plt.xlabel('Epoch')
plt.ylabel('Accuracy')
plt.grid(True, alpha=0.3)
plt.legend()

# 绘制mean_iou曲线
plt.subplot(2, 2, 2)
plt.plot(epochs, mean_iou, 'g-', linewidth=2, label='Mean IoU')
plt.title('Mean IoU Over Epochs')
plt.xlabel('Epoch')
plt.ylabel('Mean IoU')
plt.grid(True, alpha=0.3)
plt.legend()

# 绘制top1准确度曲线
plt.subplot(2, 2, 3)
plt.plot(epochs, top1_acc, 'r-', linewidth=2, label='Top-1 Accuracy')
plt.title('Top-1 Accuracy Over Epochs')
plt.xlabel('Epoch')
plt.ylabel('Top-1 Accuracy')
plt.grid(True, alpha=0.3)
plt.legend()

# 绘制top5准确度曲线
plt.subplot(2, 2, 4)
plt.plot(epochs, top5_acc, 'purple', linewidth=2, label='Top-5 Accuracy')
plt.title('Top-5 Accuracy Over Epochs')
plt.xlabel('Epoch')
plt.ylabel('Top-5 Accuracy')
plt.grid(True, alpha=0.3)
plt.legend()

plt.tight_layout()
plt.show()

# 绘制综合曲线
plt.figure(figsize=(14, 8))
plt.plot(epochs, acc, 'b-', linewidth=2, label='Accuracy')
plt.plot(epochs, mean_iou, 'g-', linewidth=2, label='Mean IoU')
plt.plot(epochs, [x * 100 for x in top1_acc], 'r-', linewidth=2, label='Top-1 Accuracy (×100)')
plt.plot(epochs, [x * 200 for x in top5_acc], 'purple', linewidth=2, label='Top-5 Accuracy (×200)')

plt.title('Training Metrics Over Epochs', fontsize=14)
plt.xlabel('Epoch', fontsize=12)
plt.ylabel('Metric Value', fontsize=12)
plt.grid(True, alpha=0.3)
plt.legend(fontsize=10)
plt.tight_layout()
plt.show()